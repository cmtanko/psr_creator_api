{"version":3,"sources":["../../src/report/emailService.js"],"names":["_","require","nodemailer","sendEmail","data","result","cb","transporter","createTransport","service","auth","user","email","pass","password","htmlCompose","commitsByUsers","forEach","get","commit","taskId","taskTitle","taskStatus","totalTime","mailOptions","from","to","email_to","subject","Date","html","sendMail","error","info"],"mappings":";;;;;AAAA,IAAIA,IAAIC,QAAQ,QAAR,CAAR;AACA,IAAIC,aAAaD,QAAQ,YAAR,CAAjB;;AAEO,IAAME,gCAAY,SAAZA,SAAY,CAAUC,IAAV,EAAgBC,MAAhB,EAAwBC,EAAxB,EAA4B;AACjD,QAAIC,cAAcL,WAAWM,eAAX,CAA2B;AACzCC,iBAAS,OADgC;AAEzCC,cAAM;AACFC,kBAAMP,KAAKQ,KADT;AAEFC,kBAAMT,KAAKU;AAFT;AAFmC,KAA3B,CAAlB;;AAQA,QAAIC,cAAc,EAAlB;AACAV,WAAOW,cAAP,CAAsBC,OAAtB,CAA8B,UAAUN,IAAV,EAAgB;AAC1CI,uBAAe,SAASJ,KAAKA,IAAd,GAAqB,OAApC;AACAI,uBAAe,MAAf;AACAf,UAAEkB,GAAF,CAAMP,IAAN,EAAY,SAAZ,EAAuBM,OAAvB,CAA+B,UAAUE,MAAV,EAAkB;AAC7CJ,2BAAe,SAASI,OAAOC,MAAhB,GAAyB,KAAzB,GAAiCD,OAAOE,SAAxC,GAAoD,GAApD,GAA0DF,OAAOG,UAAjE,GAA8E,QAA7F;AACH,SAFD,EAEGP,WAFH;AAGAA,uBAAe,OAAf;AACAA,uBAAe,cAAcJ,KAAKY,SAAnB,GAA+B,iBAA9C;AACH,KARD,EAQG,IARH;;AAUA,QAAIC,cAAc;AACdC,cAAMrB,KAAKQ,KADG;AAEdc,YAAItB,KAAKuB,QAFK;AAGdC,iBAAS,oBAAoB,IAAIC,IAAJ,EAHf;AAIdC,cAAMf;AAJQ,KAAlB;;AAOAR,gBAAYwB,QAAZ,CAAqBP,WAArB,EAAkC,UAAUQ,KAAV,EAAiBC,IAAjB,EAAuB;AACrD,YAAID,KAAJ,EAAW;AACP1B,eAAG,IAAH,EAAS0B,KAAT;AAEH,SAHD,MAGO;AACH1B,eAAG,IAAH,EAAS2B,IAAT;AACH;AACJ,KAPD;AAQH,CAnCM;;kBAqCQ9B,S","file":"emailService.js","sourcesContent":["var _ = require('lodash');\nvar nodemailer = require('nodemailer');\n\nexport const sendEmail = function (data, result, cb) {\n    var transporter = nodemailer.createTransport({\n        service: 'gmail',\n        auth: {\n            user: data.email,\n            pass: data.password\n        }\n    });\n\n    var htmlCompose = '';\n    result.commitsByUsers.forEach(function (user) {\n        htmlCompose += '<h2>' + user.user + '</h2>';\n        htmlCompose += '<ul>';\n        _.get(user, 'commits').forEach(function (commit) {\n            htmlCompose += '<li>' + commit.taskId + ' | ' + commit.taskTitle + '(' + commit.taskStatus + ')</li>';\n        }, htmlCompose);\n        htmlCompose += '</ul>';\n        htmlCompose += '<ul><li>(' + user.totalTime + ' hrs)</li></ul>'\n    }, this);\n\n    var mailOptions = {\n        from: data.email,\n        to: data.email_to,\n        subject: 'Daily Report | ' + new Date(),\n        html: htmlCompose\n    };\n\n    transporter.sendMail(mailOptions, function (error, info) {\n        if (error) {\n            cb(null, error);\n\n        } else {\n            cb(null, info);\n        }\n    });\n}\n\nexport default sendEmail;"]}