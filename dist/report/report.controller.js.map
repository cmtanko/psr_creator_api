{"version":3,"sources":["../../src/report/report.controller.js"],"names":["router","getStatus","statusCode","get","req","res","next","send","post","query","body","assigneeString","assigneeArray","assignee","split","forEach","a","i","array","length","console","log","url","method","headers","token","then","data","results","issues","each","result","push","task_id","key","task_type","task_description","task_creation_date","task_updated_date","task_assignee","task_status","sortBy","catch"],"mappings":";;;;;;AAAA;;AACA;;;;AACA;;;;;;AAEA,IAAMA,SAAS,sBAAf;AACA,IAAMC,YAAY,SAAZA,SAAY,CAACC,UAAD,EAAgB;AAChC,MAAIA,eAAe,aAAnB,EAAkC;AAAE,WAAO,aAAP;AAAuB,GAA3D,MACK,IAAIA,eAAe,mBAAnB,EAAwC;AAAE,WAAO,WAAP;AAAqB,GAA/D,MACA,IAAIA,eAAe,0BAAnB,EAA+C;AAAE,WAAO,OAAP;AAAiB;;AAEvE,SAAOA,UAAP;AACD,CAND;AAOAF,OAAOG,GAAP,CAAW,MAAX,EAAmB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACrCD,MAAIE,IAAJ,CAAS,aAAT;AACD,CAFD;;AAIAP,OAAOQ,IAAP,CAAY,GAAZ,EAAiB,UAACJ,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACnC,MAAIG,QAAQL,IAAIM,IAAhB;AACA,MAAIC,iBAAiB,EAArB;AACA,MAAIC,gBAAgBH,MAAMI,QAAN,CAAeC,KAAf,CAAqB,GAArB,CAApB;AACAF,gBAAcG,OAAd,CAAsB,UAAUC,CAAV,EAAaC,CAAb,EAAgBC,KAAhB,EAAuB;AAC3C,QAAID,MAAMC,MAAMC,MAAN,GAAe,CAAzB,EAA4B;AAC1BR,wBAAkB,cAAcK,CAAhC;AACD,KAFD,MAEO;AACLL,wBAAkB,cAAcK,CAAd,GAAkB,IAApC;AACD;AACF,GAND,EAMGL,cANH;AAOAS,UAAQC,GAAR,CAAYV,cAAZ;AACA,kBAAMR,GAAN,CAAUM,MAAMa,GAAN,GAAY,8BAAZ,GAA6CX,cAA7C,GAA8D,cAA9D,GAA+E,MAAMC,cAAcO,MAA7G,EACE;AACEI,YAAQ,KADV;AAEEC,aAAS,EAAE,iBAAiB,WAAWf,MAAMgB,KAApC;AAFX,GADF,EAKEC,IALF,CAKO,UAACC,IAAD,EAAU;AACf,QAAIC,UAAUD,KAAKA,IAAL,CAAUE,MAAxB;AACA,QAAIA,SAAS,EAAb;AACA,qBAAEC,IAAF,CAAOF,OAAP,EAAgB,UAACG,MAAD,EAAY;AAC1B,UAAI,iBAAE5B,GAAF,CAAM4B,MAAN,EAAc,oBAAd,MAAwC,MAAxC,IAAkD,iBAAE5B,GAAF,CAAM4B,MAAN,EAAc,oBAAd,MAAwC,SAA9F,EAAyG;AACvGF,eAAOG,IAAP,CAAY;AACVC,mBAASF,OAAOG,GADN;AAEVC,qBAAW,iBAAEhC,GAAF,CAAM4B,MAAN,EAAc,uBAAd,CAFD;AAGVK,4BAAkB,iBAAEjC,GAAF,CAAM4B,MAAN,EAAc,gBAAd,CAHR;AAIVM,8BAAoB,iBAAElC,GAAF,CAAM4B,MAAN,EAAc,gBAAd,CAJV;AAKVO,6BAAmB,iBAAEnC,GAAF,CAAM4B,MAAN,EAAc,gBAAd,CALT;AAMVQ,yBAAe,iBAAEpC,GAAF,CAAM4B,MAAN,EAAc,6BAAd,CANL;AAOVS,uBAAavC,UAAU,iBAAEE,GAAF,CAAM4B,MAAN,EAAc,oBAAd,CAAV;AAPH,SAAZ;AASD;AACF,KAZD;AAaAH,cAAU,iBAAEa,MAAF,CAASZ,MAAT,EAAiB,CAAC,aAAD,EAAgB,SAAhB,CAAjB,CAAV;AACAxB,QAAIE,IAAJ,CAAS,EAAE,UAAUqB,OAAZ,EAAT;AACD,GAvBD,EAwBGc,KAxBH,CAwBS,UAACf,IAAD,EAAU;AACftB,QAAIE,IAAJ,CAAS,EAAE,SAAS,uBAAX,EAAT;AACD,GA1BH;AA2BD,CAvCD;;kBAyCeP,M","file":"report.controller.js","sourcesContent":["import { Router } from 'express';\nimport axios from 'axios';\nimport _ from 'lodash';\n\nconst router = Router();\nconst getStatus = (statusCode) => {\n  if (statusCode === 'In Progress') { return 'In Progress'; }\n  else if (statusCode === 'Ready For Testing') { return 'Completed'; }\n  else if (statusCode === 'Selected for Development') { return 'To Do'; }\n\n  return statusCode;\n};\nrouter.get('/abc', (req, res, next) => {\n  res.send('asdfasdfsdf');\n});\n\nrouter.post('/', (req, res, next) => {\n  let query = req.body;\n  let assigneeString = \"\";\n  let assigneeArray = query.assignee.split(',');\n  assigneeArray.forEach(function (a, i, array) {\n    if (i === array.length - 1) {\n      assigneeString += 'assignee=' + a;\n    } else {\n      assigneeString += 'assignee=' + a + '||';\n    }\n  }, assigneeString);\n  console.log(assigneeString);\n  axios.get(query.url + '/rest/api/latest/search?jql=' + assigneeString + '&maxResults=' + 100 * assigneeArray.length,\n    {\n      method: 'GET',\n      headers: { 'Authorization': 'Basic ' + query.token }\n    }\n  ).then((data) => {\n    let results = data.data.issues;\n    let issues = [];\n    _.each(results, (result) => {\n      if (_.get(result, 'fields.status.name') !== 'Done' && _.get(result, 'fields.status.name') !== 'Backlog') {\n        issues.push({\n          task_id: result.key,\n          task_type: _.get(result, 'fields.issuetype.name'),\n          task_description: _.get(result, 'fields.summary'),\n          task_creation_date: _.get(result, 'fields.created'),\n          task_updated_date: _.get(result, 'fields.updated'),\n          task_assignee: _.get(result, 'fields.assignee.displayName'),\n          task_status: getStatus(_.get(result, 'fields.status.name'))\n        });\n      }\n    }, this);\n    results = _.sortBy(issues, ['task_status', 'task_id']);\n    res.send({ 'result': results });\n  })\n    .catch((data) => {\n      res.send({ 'error': 'Unable to fetch data!' });\n    });\n});\n\nexport default router;"]}