{"version":3,"sources":["../../src/utils/emailService.js"],"names":["_","require","nodemailer","sendEmail","data","result","cb","transporter","createTransport","service","auth","user","email","pass","password","htmlCompose","commitsByUsers","forEach","get","commit","taskId","taskTitle","taskStatus","totalTime","mailOptions","from","to","email_to","subject","Date","html","sendMail","error","info"],"mappings":";;;;;AAAA,IAAIA,IAAIC,QAAQ,QAAR,CAAR;AACA,IAAIC,aAAaD,QAAQ,YAAR,CAAjB;;AAEO,IAAME,gCAAY,SAAZA,SAAY,CAACC,IAAD,EAAOC,MAAP,EAAeC,EAAf,EAAsB;AAC9C,KAAIC,cAAcL,WAAWM,eAAX,CAA2B;AAC5CC,WAAS,OADmC;AAE5CC,QAAM;AACLC,SAAMP,KAAKQ,KADN;AAELC,SAAMT,KAAKU;AAFN;AAFsC,EAA3B,CAAlB;;AAQA,KAAIC,cAAc,EAAlB;AACAV,QAAOW,cAAP,CAAsBC,OAAtB,CAA8B,UAACN,IAAD,EAAU;AACvCI,iBAAe,SAASJ,KAAKA,IAAd,GAAqB,OAApC;AACAI,iBAAe,MAAf;AACAf,IAAEkB,GAAF,CAAMP,IAAN,EAAY,SAAZ,EAAuBM,OAAvB,CAA+B,UAACE,MAAD,EAAY;AAC1CJ,kBAAe,SAASI,OAAOC,MAAhB,GAAyB,KAAzB,GAAiCD,OAAOE,SAAxC,GAAoD,GAApD,GAA0DF,OAAOG,UAAjE,GAA8E,QAA7F;AACA,GAFD,EAEGP,WAFH;AAGAA,iBAAe,OAAf;AACAA,iBAAe,cAAcJ,KAAKY,SAAnB,GAA+B,iBAA9C;AACA,EARD;;AAUA,KAAIC,cAAc;AACjBC,QAAMrB,KAAKQ,KADM;AAEjBc,MAAItB,KAAKuB,QAFQ;AAGjBC,WAAS,oBAAoB,IAAIC,IAAJ,EAHZ;AAIjBC,QAAMf;AAJW,EAAlB;;AAOAR,aAAYwB,QAAZ,CAAqBP,WAArB,EAAkC,UAACQ,KAAD,EAAQC,IAAR,EAAiB;AAClD,MAAID,KAAJ,EAAW;AACV1B,MAAG,IAAH,EAAS0B,KAAT;AACA,GAFD,MAEO;AACN1B,MAAG,IAAH,EAAS2B,IAAT;AACA;AACD,EAND;AAOA,CAlCM;;kBAoCQ9B,S","file":"emailService.js","sourcesContent":["var _ = require('lodash');\nvar nodemailer = require('nodemailer');\n\nexport const sendEmail = (data, result, cb) => {\n\tvar transporter = nodemailer.createTransport({\n\t\tservice: 'gmail',\n\t\tauth: {\n\t\t\tuser: data.email,\n\t\t\tpass: data.password\n\t\t}\n\t});\n\n\tvar htmlCompose = '';\n\tresult.commitsByUsers.forEach((user) => {\n\t\thtmlCompose += '<h2>' + user.user + '</h2>';\n\t\thtmlCompose += '<ul>';\n\t\t_.get(user, 'commits').forEach((commit) => {\n\t\t\thtmlCompose += '<li>' + commit.taskId + ' | ' + commit.taskTitle + '(' + commit.taskStatus + ')</li>';\n\t\t}, htmlCompose);\n\t\thtmlCompose += '</ul>';\n\t\thtmlCompose += '<ul><li>(' + user.totalTime + ' hrs)</li></ul>';\n\t}, this);\n\n\tvar mailOptions = {\n\t\tfrom: data.email,\n\t\tto: data.email_to,\n\t\tsubject: 'Daily Report | ' + new Date(),\n\t\thtml: htmlCompose\n\t};\n\n\ttransporter.sendMail(mailOptions, (error, info) => {\n\t\tif (error) {\n\t\t\tcb(null, error);\n\t\t} else {\n\t\t\tcb(null, info);\n\t\t}\n\t});\n};\n\nexport default sendEmail;"]}